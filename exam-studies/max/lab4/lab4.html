
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="https://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="https://yihui.name/knitr/"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.18</code>)
    by by .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">########################## Lab 4 ##########################</span>
<span class="hl com">## MCMC</span>
<span class="hl com">## Metropolis algorithm</span>
<span class="hl com">## Poisson regression</span>
<span class="hl com">## Hessian</span>
<span class="hl com">## Mode</span>
<span class="hl com">## Maximum likelihood estimator</span>
<span class="hl com">## Program general functions</span>

<span class="hl com"># Task 1: Poisson regression - the MCMC way</span>
<span class="hl com"># a) Obtain the maximum likelihood estimator of β in the Poisson regression model</span>
<span class="hl com"># Find significant covariates</span>
<span class="hl com"># b) Bayesian analysis of the Poisson regression</span>
<span class="hl com"># Find mode and hessian of Beta</span>
<span class="hl com"># c) Simulate from the actual posterior of β using the Metropolis algorithm and </span>
<span class="hl com"># compare with the approximate results in b)</span>
<span class="hl com"># Program general function</span>
<span class="hl com"># d) Use MCMC draws from c) to simulate from the predictive distribution of</span>
<span class="hl com"># the number of bidders in a new auction</span>

<span class="hl com">#####################################################################################################</span>

<span class="hl kwd">library</span><span class="hl std">(mvtnorm)</span>

<span class="hl com">############# Task 1 #############</span>
<span class="hl com"># Consider the following Poisson regression model:</span>
<span class="hl com">#   y_i | β ~ Poisson[ exp(t(x_i) * β ) ], i = 1, ..., n</span>

<span class="hl std">dataset</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.table</span><span class="hl std">(</span><span class="hl str">&quot;eBayNumberOfBidderData.dat&quot;</span><span class="hl std">,</span> <span class="hl kwc">header</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl std">X</span> <span class="hl kwb">&lt;-</span> <span class="hl std">dataset[,</span> <span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">]</span>
<span class="hl std">Y</span> <span class="hl kwb">&lt;-</span> <span class="hl std">dataset[,</span> <span class="hl num">1</span><span class="hl std">]</span>

<span class="hl com"># a)</span>
<span class="hl com"># Obtain the maximum likelihood estimatior of β</span>

<span class="hl com"># Fit Poisson model</span>
<span class="hl std">nBids.fitted</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">glm</span><span class="hl std">(</span><span class="hl kwc">formula</span> <span class="hl std">= nBids</span> <span class="hl opt">~</span><span class="hl std">.</span><span class="hl opt">-</span><span class="hl std">Const,</span>
               <span class="hl kwc">data</span> <span class="hl std">= dataset,</span>
               <span class="hl kwc">family</span> <span class="hl std">= poisson)</span>

<span class="hl com"># Find significant coefficients</span>
<span class="hl com"># 99.9%: (Intercept), VerifyID, Sealed, LogBook, MinBidShare</span>
<span class="hl com"># 95%: MajBlen</span>
<span class="hl std">nBids.summary</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">summary</span><span class="hl std">(nBids.fitted)</span>

<span class="hl com"># b)</span>
<span class="hl com"># Bayesian Analysis of the Poisson regression</span>
<span class="hl com"># Zellner's prior:</span>
<span class="hl com">#     β ~ N(0, 100 * (t(X)*X)^(-1)), X: n x p covariate matrix</span>
<span class="hl com">#</span>
<span class="hl com"># Approximate posterior density:</span>
<span class="hl com">#     β | y ~ N[ B_hat, Jy(β_hat)^(-1) ]</span>

<span class="hl com"># Functions</span>
<span class="hl std">logPostPois</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">β</span><span class="hl std">,</span> <span class="hl kwc">mu</span><span class="hl std">,</span> <span class="hl kwc">sigma</span><span class="hl std">,</span> <span class="hl kwc">y</span><span class="hl std">,</span> <span class="hl kwc">X</span><span class="hl std">) {</span>
  <span class="hl std">n</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">length</span><span class="hl std">(Y)</span>

  <span class="hl com"># log likelihood</span>
  <span class="hl std">log.likelihood</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(y</span> <span class="hl opt">*</span> <span class="hl std">X</span> <span class="hl opt">%*%</span> <span class="hl std">β</span> <span class="hl opt">-</span> <span class="hl kwd">exp</span><span class="hl std">(X</span> <span class="hl opt">%*%</span> <span class="hl std">β))</span>

  <span class="hl com"># If log.likelihood -Inf or Inf</span>
  <span class="hl kwa">if</span> <span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(log.likelihood)</span> <span class="hl opt">==</span> <span class="hl num">Inf</span><span class="hl std">) log.likelihood</span> <span class="hl kwb">=</span> <span class="hl opt">-</span><span class="hl num">20000</span><span class="hl std">;</span>

  <span class="hl com"># log prior</span>
  <span class="hl com"># OBS: Use dmvnorm!! You want the likelihood of the betas!</span>
  <span class="hl std">log.prior</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">dmvnorm</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= β,</span> <span class="hl kwc">mean</span> <span class="hl std">= mu,</span> <span class="hl kwc">sigma</span> <span class="hl std">= sigma,</span> <span class="hl kwc">log</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>

  <span class="hl kwd">return</span> <span class="hl std">(log.likelihood</span> <span class="hl opt">+</span> <span class="hl std">log.prior)</span>
<span class="hl std">}</span>

<span class="hl com"># Setup</span>
<span class="hl std">X.matrix</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(X)</span>
<span class="hl std">beta_init</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(</span><span class="hl num">10</span> <span class="hl opt">*</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwd">dim</span><span class="hl std">(X.matrix)[</span><span class="hl num">2</span><span class="hl std">]))</span>
<span class="hl std">sigma</span> <span class="hl kwb">&lt;-</span> <span class="hl num">100</span> <span class="hl opt">*</span> <span class="hl kwd">solve</span><span class="hl std">(</span><span class="hl kwd">t</span><span class="hl std">(X.matrix)</span><span class="hl opt">%*%</span><span class="hl std">(X.matrix))</span>
<span class="hl std">mu</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwd">dim</span><span class="hl std">(sigma)[</span><span class="hl num">2</span><span class="hl std">])</span>
<span class="hl std">optim.res</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">optim</span><span class="hl std">(</span><span class="hl kwc">par</span> <span class="hl std">= beta_init,</span>
                   <span class="hl kwc">fn</span> <span class="hl std">= logPostPois,</span>
                   <span class="hl kwc">gr</span> <span class="hl std">=</span> <span class="hl kwa">NULL</span><span class="hl std">,</span>
                   <span class="hl kwc">mu</span> <span class="hl std">= mu,</span>
                   <span class="hl kwc">sigma</span> <span class="hl std">= sigma,</span>
                   <span class="hl kwc">y</span> <span class="hl std">= Y,</span>
                   <span class="hl kwc">X</span> <span class="hl std">= X.matrix,</span>
                   <span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">&quot;BFGS&quot;</span><span class="hl std">,</span>
                   <span class="hl kwc">control</span> <span class="hl std">=</span> <span class="hl kwd">list</span><span class="hl std">(</span><span class="hl kwc">fnscale</span> <span class="hl std">=</span> <span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">),</span>
                   <span class="hl kwc">hessian</span> <span class="hl std">=</span> <span class="hl num">TRUE</span>
                   <span class="hl std">)</span>

<span class="hl std">β.mode</span> <span class="hl kwb">&lt;-</span> <span class="hl std">optim.res</span><span class="hl opt">$</span><span class="hl std">par</span> <span class="hl com"># Mode of betas</span>
<span class="hl std">β.neg.inv.hessian</span> <span class="hl kwb">&lt;-</span> <span class="hl opt">-</span><span class="hl kwd">solve</span><span class="hl std">(optim.res</span><span class="hl opt">$</span><span class="hl std">hessian)</span> <span class="hl com"># Negative inverse hessian, when betas = mode</span>

<span class="hl com"># c) Metropolis</span>

<span class="hl com"># Functions</span>
<span class="hl std">Metropolis</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">theta</span><span class="hl std">,</span> <span class="hl kwc">logPostFunc</span><span class="hl std">,</span> <span class="hl kwc">c</span><span class="hl std">,</span> <span class="hl kwc">Σ</span><span class="hl std">,</span> <span class="hl kwc">nDraws</span><span class="hl std">,</span> <span class="hl kwc">warmUp</span><span class="hl std">,</span> <span class="hl kwc">...</span><span class="hl std">) {</span>
  <span class="hl std">theta_c</span> <span class="hl kwb">&lt;-</span> <span class="hl std">theta</span> <span class="hl com"># theta_c: Current thetas</span>
  <span class="hl std">thetas</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">matrix</span><span class="hl std">(</span><span class="hl kwc">nrow</span> <span class="hl std">= nDraws,</span>
                   <span class="hl kwc">ncol</span> <span class="hl std">=</span> <span class="hl kwd">length</span><span class="hl std">(theta))</span>
  <span class="hl std">sigma_c</span> <span class="hl kwb">&lt;-</span> <span class="hl std">c</span> <span class="hl opt">*</span> <span class="hl std">Σ</span>
  <span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl opt">-</span><span class="hl std">warmUp</span><span class="hl opt">:</span><span class="hl std">nDraws) {</span>

    <span class="hl com"># Generate new thetas in the surounding area of theta_c</span>
    <span class="hl std">theta_p</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.vector</span><span class="hl std">(</span><span class="hl kwd">rmvnorm</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">mean</span> <span class="hl std">= theta_c,</span> <span class="hl kwc">sigma</span> <span class="hl std">= sigma_c))</span>

    <span class="hl std">log.post.p</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">logPostFunc</span><span class="hl std">(theta_p, ...)</span>
    <span class="hl std">log.post.c</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">logPostFunc</span><span class="hl std">(theta_c, ...)</span>

    <span class="hl com"># Calculate the acceptance probability.</span>
    <span class="hl com"># If there's a high probability of theta_p, accept_prob will be equal to 1 and the bern trial will </span>
    <span class="hl com"># draw in its favour.</span>
    <span class="hl std">accept_prob</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">min</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwd">exp</span><span class="hl std">(log.post.p</span> <span class="hl opt">-</span> <span class="hl std">log.post.c))</span>

    <span class="hl com"># Bern trial to decide if theta_c should continue as before or if a &quot;jump&quot; to newly generated theta_p should be made</span>
    <span class="hl std">bern_trial</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbinom</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">prob</span> <span class="hl std">= accept_prob)</span>

    <span class="hl com"># Set theta_c to new value</span>
    <span class="hl kwa">if</span> <span class="hl std">(bern_trial</span> <span class="hl opt">==</span> <span class="hl num">1</span><span class="hl std">) {</span>
      <span class="hl std">theta_c</span> <span class="hl kwb">&lt;-</span> <span class="hl std">theta_p</span>
    <span class="hl std">}</span>

    <span class="hl com"># When burn-in is passed, start to save the theta-values</span>
    <span class="hl kwa">if</span><span class="hl std">(i</span> <span class="hl opt">&gt;</span> <span class="hl num">0</span><span class="hl std">) thetas[i, ]</span> <span class="hl kwb">&lt;-</span> <span class="hl std">theta_c;</span>
  <span class="hl std">}</span>

  <span class="hl kwd">return</span><span class="hl std">(thetas)</span>
<span class="hl std">}</span>

<span class="hl com"># Setup</span>
<span class="hl std">X.matrix</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(X)</span>
<span class="hl std">beta_init</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwd">dim</span><span class="hl std">(X.matrix)[</span><span class="hl num">2</span><span class="hl std">])</span>
<span class="hl std">sigma</span> <span class="hl kwb">&lt;-</span> <span class="hl num">100</span> <span class="hl opt">*</span> <span class="hl kwd">solve</span><span class="hl std">(</span><span class="hl kwd">t</span><span class="hl std">(X.matrix)</span><span class="hl opt">%*%</span><span class="hl std">(X.matrix))</span>
<span class="hl std">mu</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwd">dim</span><span class="hl std">(sigma)[</span><span class="hl num">2</span><span class="hl std">])</span>
<span class="hl std">c</span> <span class="hl kwb">=</span> <span class="hl num">0.5</span>

<span class="hl std">nDraws</span> <span class="hl kwb">=</span> <span class="hl num">4000</span> <span class="hl com"># No. of draws</span>
<span class="hl std">warmUp</span> <span class="hl kwb">=</span> <span class="hl kwd">round</span><span class="hl std">(nDraws</span><span class="hl opt">/</span><span class="hl num">5</span><span class="hl std">)</span> <span class="hl com"># No. of Burn-in</span>

<span class="hl std">metropolis.res</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">Metropolis</span><span class="hl std">(</span><span class="hl kwc">theta</span> <span class="hl std">= beta_init,</span>
                             <span class="hl kwc">logPostFunc</span> <span class="hl std">= logPostPois,</span>
                             <span class="hl kwc">c</span> <span class="hl std">= c,</span>
                             <span class="hl kwc">Σ</span> <span class="hl std">= β.neg.inv.hessian,</span>
                             <span class="hl kwc">nDraws</span> <span class="hl std">= nDraws,</span>
                             <span class="hl kwc">warmUp</span> <span class="hl std">= warmUp,</span>
                             <span class="hl kwc">mu</span> <span class="hl std">= mu,</span>
                             <span class="hl kwc">sigma</span> <span class="hl std">= sigma,</span>
                             <span class="hl kwc">y</span> <span class="hl std">= Y,</span>
                             <span class="hl kwc">X</span> <span class="hl std">= X.matrix)</span>

<span class="hl std">postPhi</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">exp</span><span class="hl std">(metropolis.res)</span> <span class="hl com"># Phi = exp(β) is often more interprentable</span>

<span class="hl com"># Plot β</span>
<span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mfrow</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">3</span><span class="hl std">,</span> <span class="hl num">3</span><span class="hl std">))</span>
<span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl kwd">dim</span><span class="hl std">(metropolis.res)[</span><span class="hl num">2</span><span class="hl std">]) {</span>
  <span class="hl std">main_legend</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;β&quot;</span><span class="hl std">, i),</span> <span class="hl kwc">collapse</span> <span class="hl std">=</span> <span class="hl str">&quot;&quot;</span><span class="hl std">)</span>
  <span class="hl kwd">plot</span><span class="hl std">(</span><span class="hl kwd">density</span><span class="hl std">(metropolis.res[, i]),</span>
       <span class="hl kwc">main</span> <span class="hl std">= main_legend,</span>
       <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">'l'</span><span class="hl std">,</span>
       <span class="hl kwc">ylab</span> <span class="hl std">= main_legend)</span>
<span class="hl std">}</span>
</pre></div>
</div><div class="rimage center"><img src="figure/lab4-Rhtmlauto-report-1.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># Plot Phis</span>
<span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mfrow</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">3</span><span class="hl std">,</span> <span class="hl num">3</span><span class="hl std">))</span>
<span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl kwd">dim</span><span class="hl std">(postPhi)[</span><span class="hl num">2</span><span class="hl std">]) {</span>
  <span class="hl std">main_legend</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Phi:&quot;</span><span class="hl std">, i),</span> <span class="hl kwc">collapse</span> <span class="hl std">=</span> <span class="hl str">&quot; &quot;</span><span class="hl std">)</span>
  <span class="hl kwd">plot</span><span class="hl std">(</span><span class="hl kwd">density</span><span class="hl std">(postPhi[, i]),</span>
       <span class="hl kwc">main</span> <span class="hl std">= main_legend,</span>
       <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">'l'</span><span class="hl std">,</span>
       <span class="hl kwc">ylab</span> <span class="hl std">= main_legend)</span>
<span class="hl std">}</span>
</pre></div>
</div><div class="rimage center"><img src="figure/lab4-Rhtmlauto-report-2.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># d) Use draws in c) to simulate the predictive distribution of a new bid</span>

<span class="hl std">new_bid</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">0.5</span><span class="hl std">)</span>

<span class="hl com"># Simulation from predictive distribution by using Metropolis betas</span>
<span class="hl com"># Simulate from Poisson distribution with lambda = exp(x_i * β)</span>
<span class="hl std">lambda</span> <span class="hl kwb">&lt;-</span> <span class="hl std">metropolis.res</span> <span class="hl opt">%*%</span> <span class="hl std">new_bid</span>
<span class="hl std">pred</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rpois</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">= nDraws,</span>
              <span class="hl kwd">exp</span><span class="hl std">(lambda))</span>

<span class="hl com"># Hist draws</span>
<span class="hl kwd">hist</span><span class="hl std">(pred,</span> <span class="hl kwc">breaks</span> <span class="hl std">=</span> <span class="hl num">30</span><span class="hl std">)</span>

<span class="hl com"># Calculate probability of no bidders</span>
<span class="hl std">prob_no_bidder</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(pred</span> <span class="hl opt">==</span> <span class="hl num">0</span><span class="hl std">)</span><span class="hl opt">/</span><span class="hl kwd">length</span><span class="hl std">(pred)</span>

<span class="hl kwd">stitch</span><span class="hl std">(</span><span class="hl kwc">script</span><span class="hl std">=</span><span class="hl str">&quot;lab3.R&quot;</span><span class="hl std">,</span> <span class="hl kwd">system.file</span><span class="hl std">(</span><span class="hl str">&quot;misc&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;knitr-template.Rhtml&quot;</span><span class="hl std">,</span> <span class="hl kwc">package</span><span class="hl std">=</span><span class="hl str">&quot;knitr&quot;</span><span class="hl std">))</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in file(con, &quot;r&quot;): cannot open file 'lab3.R': No such file or directory
</pre></div>
<div class="error"><pre class="knitr r">## Error in file(con, &quot;r&quot;): cannot open the connection
</pre></div>
</div><div class="rimage center"><img src="figure/lab4-Rhtmlauto-report-3.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 3.4.2 (2017-09-28)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: OS X El Capitan 10.11.6
## 
## Matrix products: default
## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] mvtnorm_1.0-7      knitr_1.18         rstan_2.17.3       StanHeaders_2.17.2
## [5] ggplot2_2.2.1     
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.13     codetools_0.2-15 grid_3.4.2       plyr_1.8.4       gtable_0.2.0    
##  [6] magrittr_1.5     stats4_3.4.2     evaluate_0.10.1  scales_0.5.0     highr_0.6       
## [11] stringi_1.1.5    rlang_0.1.4      lazyeval_0.2.1   tools_3.4.2      stringr_1.2.0   
## [16] munsell_0.4.3    yaml_2.1.16      compiler_3.4.2   inline_0.3.14    colorspace_1.3-2
## [21] gridExtra_2.3    tibble_1.3.4
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;2018-05-28 17:35:09 CEST&quot;
</pre></div>
</div></div>


</body>
</html>
